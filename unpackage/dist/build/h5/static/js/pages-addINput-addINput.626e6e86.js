(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-addINput-addINput"],{"0c26":function(t,e,i){"use strict";i.r(e);var n=i("6ef2"),s=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=s.a},"1a4c":function(t,e,i){"use strict";var n=i("b027"),s=i.n(n);s.a},"1e3a":function(t,e,i){"use strict";var n=i("dff2"),s=i.n(n);s.a},2012:function(t,e,i){"use strict";i.r(e);var n=i("f3b4"),s=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=s.a},2438:function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".tip-before-post uni-image[data-v-addef924]{width:100%;height:100%}.tip-before-post uni-button[data-v-addef924]{background:#009687}.user-setting-userinfo-list[data-v-addef924]{padding:%?20?%;border-bottom:#f4f4f4}",""])},4839:function(t,e,i){var n=i("4f06d");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("4f06").default;s("a3fbb56c",n,!0,{sourceMap:!1,shadowMode:!1})},"4f06d":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,".uni-textarea[data-v-92aa2738]{border:%?1?% solid #eee}.cell-pd[data-v-92aa2738]{padding:%?22?% %?30?%}.list-pd[data-v-92aa2738]{margin-top:%?50?%}.icon-shanchu[data-v-92aa2738]{position:absolute;right:0;top:0;background:#333;color:#fff;padding:%?2?% %?10?%;border-radius:%?10?%;z-index:%?100?%}.uni-uploader__files[data-v-92aa2738]{position:relative}",""])},"50c6":function(t,e,i){e=t.exports=i("2350")(!1),e.push([t.i,'.uni-mask[data-v-345bd0f6]{position:fixed;z-index:998;top:0;right:0;bottom:0;left:0;background-color:rgba(0,0,0,.3)}.uni-popup[data-v-345bd0f6]{position:absolute;z-index:999;background-color:#fff}.uni-popup-middle[data-v-345bd0f6]{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-webkit-flex-direction:column;flex-direction:column;-webkit-box-align:center;-webkit-align-items:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;justify-content:center;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}.uni-popup-middle.uni-popup-insert[data-v-345bd0f6]{min-width:%?380?%;min-height:%?380?%;max-width:100%;max-height:80%;-webkit-transform:translate(-50%,-65%);transform:translate(-50%,-65%);background:none;box-shadow:none}.uni-popup-middle.uni-popup-fixed[data-v-345bd0f6]{border-radius:%?10?%;padding:%?30?%}.uni-close-bottom[data-v-345bd0f6],.uni-close-right[data-v-345bd0f6]{position:absolute;bottom:%?-180?%;text-align:center;border-radius:50%;color:#f5f5f5;font-size:%?60?%;font-weight:700;opacity:.8;z-index:-1}.uni-close-right[data-v-345bd0f6]{right:%?-60?%;top:%?-80?%}.uni-close-bottom[data-v-345bd0f6]:after{content:"";position:absolute;width:0;border:1px #f5f5f5 solid;top:%?-200?%;bottom:%?56?%;left:50%;-webkit-transform:translate(-50%);transform:translate(-50%);opacity:.8}.uni-popup-top[data-v-345bd0f6]{top:0;left:0;width:100%;height:%?100?%;line-height:%?100?%;text-align:center}.uni-popup-bottom[data-v-345bd0f6]{left:0;bottom:0;width:100%;min-height:%?100?%;line-height:%?100?%;text-align:center}',""])},"6ef2":function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("768b"));i("96cf");var a=n(i("3b8d")),o=[["camera"],["album"],["camera","album"]],r=[["compressed"],["original"],["compressed","original"]],u={props:{imglist:Array},data:function(){return{sourceTypeIndex:2,sourceType:["拍照","相册","拍照或相册"],sizeTypeIndex:2,sizeType:["压缩","原图","压缩或原图"],countIndex:8,count:[1,2,3,4,5,6,7,8,9]}},methods:{chooseImage:function(){var t=(0,a.default)(regeneratorRuntime.mark(function t(){var e=this;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(9!==this.imglist.length){t.next=2;break}return t.abrupt("return");case 2:uni.chooseImage({sourceType:o[this.sourceTypeIndex],sizeType:r[this.sizeTypeIndex],count:this.imglist.length+this.count[this.countIndex]>9?9-this.imglist.length:this.count[this.countIndex],success:function(t){console.log("获取路径信息"),console.log(t);for(var i=0;i<t.tempFilePaths.length;i++)e.Upload(t.tempFilePaths[i])},fail:function(t){}});case 3:case"end":return t.stop()}},t,this)}));function e(){return t.apply(this,arguments)}return e}(),deletePic:function(){var t=this;uni.showModal({title:"提示",content:"是否删除所有图片",success:function(e){e.confirm&&t.$emit("del")}})},previewImage:function(t){var e=t.target.dataset.src;uni.previewImage({current:e,urls:this.imglist})},checkPermission:function(){var t=(0,a.default)(regeneratorRuntime.mark(function t(e){var i,n;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=e?e-1:this.sourceTypeIndex,!permision.isIOS){t.next=7;break}return t.next=4,permision.requestIOS(o[i][0]);case 4:t.t0=t.sent,t.next=10;break;case 7:return t.next=9,permision.requestAndroid(0===i?"android.permission.CAMERA":"android.permission.READ_EXTERNAL_STORAGE");case 9:t.t0=t.sent;case 10:return n=t.t0,null===n||1===n?n=1:uni.showModal({content:"没有开启权限",confirmText:"设置",success:function(t){t.confirm&&permision.gotoAppSetting()}}),t.abrupt("return",n);case 13:case"end":return t.stop()}},t,this)}));function e(e){return t.apply(this,arguments)}return e}(),Upload:function(){var t=(0,a.default)(regeneratorRuntime.mark(function t(e){var i,n,a,o,r,u;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.$http.upload("image/uploadmore",{name:"imglist[]",filePath:e,token:!0,checkToken:!0});case 3:if(i=t.sent,n=(0,s.default)(i,2),a=n[0],o=n[1],r=JSON.parse(o.data),!a&&!r.errorCode){t.next=11;break}return uni.showToast({title:r.msg?r.msg:"上传失败",icon:"none"}),t.abrupt("return",!1);case 11:u=r.data.list,this.$emit("upload",u[0]),t.next=18;break;case 15:return t.prev=15,t.t0=t["catch"](0),t.abrupt("return");case 18:case"end":return t.stop()}},t,this,[[0,15]])}));function e(e){return t.apply(this,arguments)}return e}()}};e.default=u},"7e5c":function(t,e,i){"use strict";i.r(e);var n=i("d783"),s=i("0c26");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("ac6b");var o,r=i("f0c5"),u=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"92aa2738",null,!1,n["a"],o);e["default"]=u.exports},"8ea8":function(t,e,i){"use strict";i.r(e);var n=i("e240"),s=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=s.a},"9bfa":function(t,e,i){"use strict";var n,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("uni-nav-bar",{attrs:{rightText:"发布",statusBar:!0,"left-icon":"arrowleft",backgroundColor:"#009687",color:"#ffffff"},on:{clickLeft:function(e){arguments[0]=e=t.$handleEvent(e),t.back.apply(void 0,arguments)},clickRight:function(e){arguments[0]=e=t.$handleEvent(e),t.submit.apply(void 0,arguments)}}},[i("v-uni-view",{staticClass:"u-f-ajc",staticStyle:{"font-size":"24upx"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeOne.apply(void 0,arguments)}}},[t._v(t._s(t.open[t.isOpen])),i("v-uni-view",{staticClass:"icon iconfont icon-xialazhankai"})],1)],1),i("v-uni-view",{staticClass:"uni-textarea"},[i("v-uni-textarea",{attrs:{placeholder:"在发言前请先阅读相应板块版规"},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}})],1),i("v-uni-view",{staticClass:"user-setting-userinfo-list u-f-ac u-f-jsb",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changePostClass()}}},[i("v-uni-view",{},[t._v("板块")]),i("v-uni-view",{staticClass:"u-f-ac"},[t._v(t._s(t.postClass.title)),i("v-uni-view",{staticClass:"icon iconfont icon-jinru"})],1)],1),i("v-uni-view",{staticClass:"user-setting-userinfo-list u-f-ac u-f-jsb",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.changeTopic()}}},[i("v-uni-view",{},[t._v("话题")]),i("v-uni-view",{staticClass:"u-f-ac"},[t._v(t._s(t.topic.title)),i("v-uni-view",{staticClass:"icon iconfont icon-jinru"})],1)],1),i("upload-images",{attrs:{imglist:t.imglist},on:{upload:function(e){arguments[0]=e=t.$handleEvent(e),t.upload.apply(void 0,arguments)},del:function(e){arguments[0]=e=t.$handleEvent(e),t.delImgList.apply(void 0,arguments)}}}),i("uni-popup",{attrs:{show:t.showpop_up,position:"middle",mode:"fixed"}},[i("v-uni-view",{staticClass:"tip-before-post "},[i("v-uni-view",{staticClass:"u-f-ajc"},[i("v-uni-image",{attrs:{src:"../../static/common/ACnyn.png",mode:"widthFix"}})],1),i("v-uni-view",{staticStyle:{"font-size":"24upx"}},[t._v("* 请不要发表涉政敏感信息，遵守相关法律法规。")]),i("v-uni-view",{staticStyle:{"font-size":"24upx"}},[t._v("* 请遵循总版规和各版块分版规。")]),i("v-uni-view",{staticStyle:{"font-size":"24upx"}},[t._v("* 发布内容前提为理解并愿意遵守所有版规及免责声明。")]),i("v-uni-button",{attrs:{type:"primary"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hidePopup()}}},[t._v("我同意并接受相关条款")])],1)],1)],1)},a=[];i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"a",function(){return n})},aa79:function(t,e,i){"use strict";var n,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",[i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"uni-mask",style:{top:t.offsetTop+"px"},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.hide.apply(void 0,arguments)},touchmove:function(e){e.stopPropagation(),e.preventDefault(),arguments[0]=e=t.$handleEvent(e),t.moveHandle.apply(void 0,arguments)}}}),i("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:t.show,expression:"show"}],staticClass:"uni-popup",class:"uni-popup-"+t.position+" uni-popup-"+t.mode},[t._v(t._s(t.msg)),t._t("default"),"middle"===t.position&&"insert"===t.mode?i("v-uni-view",{staticClass:" uni-icon uni-icon-close",class:{"uni-close-bottom":"bottom"===t.buttonMode,"uni-close-right":"right"===t.buttonMode},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.closeMask.apply(void 0,arguments)}}}):t._e()],2)],1)},a=[];i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"a",function(){return n})},ac6b:function(t,e,i){"use strict";var n=i("4839"),s=i.n(n);s.a},b027:function(t,e,i){var n=i("50c6");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("4f06").default;s("5fff0391",n,!0,{sourceMap:!1,shadowMode:!1})},c9d3:function(t,e,i){"use strict";i.r(e);var n=i("aa79"),s=i("2012");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("1a4c");var o,r=i("f0c5"),u=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"345bd0f6",null,!1,n["a"],o);e["default"]=u.exports},d783:function(t,e,i){"use strict";var n,s=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("v-uni-view",{staticClass:"uni-list list-pd"},[i("v-uni-view",{staticClass:"uni-list-cell cell-pd"},[i("v-uni-view",{staticClass:"uni-uploader"},[i("v-uni-view",{staticClass:"uni-uploader-head"},[i("v-uni-view",{staticClass:"uni-uploader-title"},[t._v("点击可预览选好的图片")]),i("v-uni-view",{staticClass:"uni-uploader-info"},[t._v(t._s(t.imglist.length)+"/9")])],1),i("v-uni-view",{staticClass:"uni-uploader-body"},[i("v-uni-view",{staticClass:"uni-uploader__files"},[t._l(t.imglist,function(e,n){return[i("v-uni-view",{key:n+"_0",staticClass:"uni-uploader__file"},[i("v-uni-view",{staticClass:"icon iconfont icon-shanchu",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.deletePic()}}}),i("v-uni-image",{staticClass:"uni-uploader__img",attrs:{src:e,"data-src":e},on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.previewImage.apply(void 0,arguments)}}})],1)]}),i("v-uni-view",{staticClass:"uni-uploader__input-box"},[i("v-uni-view",{staticClass:"uni-uploader__input",on:{click:function(e){arguments[0]=e=t.$handleEvent(e),t.chooseImage.apply(void 0,arguments)}}})],1)],2)],1)],1)],1)],1)},a=[];i.d(e,"b",function(){return s}),i.d(e,"c",function(){return a}),i.d(e,"a",function(){return n})},dff2:function(t,e,i){var n=i("2438");"string"===typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);var s=i("4f06").default;s("f9e40188",n,!0,{sourceMap:!1,shadowMode:!1})},e240:function(t,e,i){"use strict";var n=i("288e");Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var s=n(i("768b"));i("96cf");var a=n(i("3b8d")),o=n(i("f499")),r=n(i("7e5c")),u=n(i("2899")),c=n(i("c9d3")),l={components:{uniNavBar:u.default,uploadImages:r.default,uniPopup:c.default},data:function(){return{open:["仅自己可见","所有人可见"],isTips2Save:!1,showpop_up:!0,title:"",postClass:{id:0,title:"",range:[],list:[]},topic:{id:0,title:""},text:"",imglist:[],imglistIds:[],isOpen:1}},methods:{saveAsDraft:function(){var t=this;uni.showModal({content:"是否保存为草稿",cancelText:"不保存",confirmText:"保存",success:function(e){if(e.confirm){console.log("save");var i={isOpen:t.isOpen,text:t.text,imglist:t.imglist,imglistIds:t.imglistIds,postClass:t.postClass,topic:t.topic};uni.setStorageSync("addinput",(0,o.default)(i))}else console.log("dont save"),uni.removeStorage({key:"addinput"});t.isTips2Save=!0,uni.navigateBack({delta:1})},fail:function(){},complete:function(){}})},upload:function(t){this.imglist.push(t.url),this.imglistIds.push({id:t.id}),console.log(this.imglist)},back:function(){uni.navigateBack({delta:1e3})},submit:function(){var t=(0,a.default)(regeneratorRuntime.mark(function t(){var e,i,n,a;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(this.postClass.id){t.next=2;break}return t.abrupt("return",uni.showToast({title:"请选择分类",icon:"none"}));case 2:return uni.showLoading({title:"发布中(*´∀`)",mask:!0}),t.prev=3,t.next=6,this.$http.post("post/create",{imglist:(0,o.default)(this.imglistIds),text:this.text,isopen:this.isOpen,topic_id:this.topic.id,post_class_id:this.postClass.id},{token:!0,checkToken:!0,checkAuth:!0});case 6:if(e=t.sent,i=(0,s.default)(e,2),n=i[0],a=i[1],console.log((0,o.default)(this.imglistIds)),this.$http.errorCheck(n,a)){t.next=15;break}return uni.showToast({title:a.msg,icon:"none"}),uni.hideLoading(),t.abrupt("return");case 15:uni.hideLoading(),uni.showToast({title:"发布成功！"}),console.log(a),this.isTips2Save=!0,uni.$emit("updateData",{type:"updateList",data:a.data.data.detail}),uni.navigateBack({delta:1}),t.next=27;break;case 23:return t.prev=23,t.t0=t["catch"](3),console.log(t.t0),t.abrupt("return");case 27:case"end":return t.stop()}},t,this,[[3,23]])}));function e(){return t.apply(this,arguments)}return e}(),changePostClass:function(){var t=this;uni.showActionSheet({itemList:this.postClass.range,success:function(e){t.postClass.id=t.postClass.list[e.tapIndex].id,t.postClass.title=t.postClass.list[e.tapIndex].name}})},changeTopic:function(){uni.navigateTo({url:"/pages/topic-nav/topic-nav?ischange="+!0})},hidePopup:function(){this.showpop_up=!1},changeOne:function(){var t=this;uni.showActionSheet({itemList:this.open,success:function(e){t.isOpen=e.tapIndex}})},getPostClass:function(){var t=(0,a.default)(regeneratorRuntime.mark(function t(e){var i,n,a,o,r,u,c,l,d,p;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(!e){t.next=5;break}for(this.postClass.list=e,i=[],n=0;n<e.length;n++)i.push(e[n].name);return t.abrupt("return",this.postClass.range=i);case 5:return t.prev=5,t.next=8,this.$http.get("postclass");case 8:if(a=t.sent,o=(0,s.default)(a,2),r=o[0],u=o[1],this.$http.errorCheck(r,u)){t.next=14;break}return t.abrupt("return");case 14:for(c=u.data.data.list,l=[],d=[],p=0;p<c.length;p++)l.push(c[p].classname),d.push({id:c[p].id,name:c[p].classname});this.postClass.range=l,this.postClass.list=d,t.next=24;break;case 21:return t.prev=21,t.t0=t["catch"](5),t.abrupt("return");case 24:case"end":return t.stop()}},t,this,[[5,21]])}));function e(e){return t.apply(this,arguments)}return e}(),delImgList:function(){this.imglist=[],this.imglistIds=[]}},onBackPress:function(){if(0!=this.text.length||0!=this.imglist.length)return this.isTips2Save?void 0:(this.saveAsDraft(),!0)},onLoad:function(t){var e=this,i=uni.getStorageSync("addinput");i&&(i=JSON.parse(i),this.isOpen=i.isOpen,this.imglistIds=i.imglistIds||[],this.imglistIds.length&&(this.imglist=i.imglist),this.text=i.text,i.postClass&&(this.postClass=i.postClass),i.topic&&(this.topic=i.topic));var n=!!t.postClass&&JSON.parse(t.postClass);this.getPostClass(n),uni.$on("changeTopic",function(t){console.log(t),e.topic.id=t.id,e.topic.title="#".concat(t.title,"#")})}};e.default=l},ef2d:function(t,e,i){"use strict";i.r(e);var n=i("9bfa"),s=i("8ea8");for(var a in s)"default"!==a&&function(t){i.d(e,t,function(){return s[t]})}(a);i("1e3a");var o,r=i("f0c5"),u=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"addef924",null,!1,n["a"],o);e["default"]=u.exports},f3b4:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n={name:"uni-popup",props:{show:{type:Boolean,default:!1},position:{type:String,default:"middle"},mode:{type:String,default:"insert"},msg:{type:String,default:""},h5Top:{type:Boolean,default:!1},buttonMode:{type:String,default:"bottom"}},data:function(){return{offsetTop:0}},watch:{h5Top:function(t){this.offsetTop=t?44:0}},methods:{hide:function(){"insert"===this.mode&&"middle"===this.position||this.$emit("hidePopup")},closeMask:function(){"insert"===this.mode&&this.$emit("hidePopup")},moveHandle:function(){}},created:function(){var t=0;t=this.h5Top?0:44,this.offsetTop=t}};e.default=n}}]);